(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{1298:(e,t,r)=>{Promise.resolve().then(r.bind(r,82534))},82534:(e,t,r)=>{"use strict";let a;r.r(t),r.d(t,{default:()=>et,dynamic:()=>ee});var n=r(95155),s=r(12115),i=r(54827),l=r(56037);let o="https://cdn.zama.ai/relayer-sdk-js/0.2.0/relayer-sdk-js.umd.cjs";class d{isLoaded(){return u(window,this._trace)}load(){if(console.log("[RelayerSDKLoader] load..."),"relayerSDK"in window){if(!c(window.relayerSDK,this._trace))throw console.log("[RelayerSDKLoader] window.relayerSDK === undefined"),Error("RelayerSDKLoader: Unable to load FHEVM Relayer SDK");return Promise.resolve()}return new Promise((e,t)=>{if(document.querySelector('script[src="'.concat(o,'"]'))){u(window,this._trace)||t(Error("RelayerSDKLoader: window object does not contain a valid relayerSDK object.")),e();return}let r=document.createElement("script");r.src=o,r.type="text/javascript",r.async=!0,r.onload=()=>{u(window,this._trace)||(console.log("[RelayerSDKLoader] script onload FAILED..."),t(Error("RelayerSDKLoader: Relayer SDK script has been successfully loaded from ".concat(o,", however, the window.relayerSDK object is invalid.")))),e()},r.onerror=()=>{console.log("[RelayerSDKLoader] script onerror... "),t(Error("RelayerSDKLoader: Failed to load Relayer SDK from ".concat(o)))},console.log("[RelayerSDKLoader] add script to DOM..."),document.head.appendChild(r),console.log("[RelayerSDKLoader] script added!")})}constructor(e){this._trace=e.trace}}function c(e,t){return void 0===e?(null==t||t("RelayerSDKLoader: relayerSDK is undefined"),!1):null===e?(null==t||t("RelayerSDKLoader: relayerSDK is null"),!1):"object"!=typeof e?(null==t||t("RelayerSDKLoader: relayerSDK is not an object"),!1):p(e,"initSDK","function",t)?p(e,"createInstance","function",t)?p(e,"SepoliaConfig","object",t)?!("__initialized__"in e)||!0===e.__initialized__||!1===e.__initialized__||(null==t||t("RelayerSDKLoader: relayerSDK.__initialized__ is invalid"),!1):(null==t||t("RelayerSDKLoader: relayerSDK.SepoliaConfig is invalid"),!1):(null==t||t("RelayerSDKLoader: relayerSDK.createInstance is invalid"),!1):(null==t||t("RelayerSDKLoader: relayerSDK.initSDK is invalid"),!1)}function u(e,t){return void 0===e?(null==t||t("RelayerSDKLoader: window object is undefined"),!1):null===e?(null==t||t("RelayerSDKLoader: window object is null"),!1):"object"!=typeof e?(null==t||t("RelayerSDKLoader: window is not an object"),!1):"relayerSDK"in e?c(e.relayerSDK):(null==t||t("RelayerSDKLoader: window does not contain 'relayerSDK' property"),!1)}function p(e,t,r,a){if(!e||"object"!=typeof e)return!1;if(!(t in e))return null==a||a("RelayerSDKLoader: missing ".concat(String(t),".")),!1;let n=e[t];return null==n?(null==a||a("RelayerSDKLoader: ".concat(String(t)," is null or undefined.")),!1):typeof n===r||(null==a||a("RelayerSDKLoader: ".concat(String(t)," is not a ").concat(r,".")),!1)}var y=r(83899);async function h(){return a||(a=(0,y.P2)("fhevm",1,{upgrade(e){e.objectStoreNames.contains("paramsStore")||e.createObjectStore("paramsStore",{keyPath:"acl"}),e.objectStoreNames.contains("publicKeyStore")||e.createObjectStore("publicKeyStore",{keyPath:"acl"})}}))}function m(e){if("object"!=typeof e)throw Error("FhevmStoredPublicKey must be an object");if(null!==e){if(!("publicKeyId"in e))throw Error("FhevmStoredPublicKey.publicKeyId does not exist");if("string"!=typeof e.publicKeyId)throw Error("FhevmStoredPublicKey.publicKeyId must be a string");if(!("publicKey"in e))throw Error("FhevmStoredPublicKey.publicKey does not exist");if(!(e.publicKey instanceof Uint8Array))throw Error("FhevmStoredPublicKey.publicKey must be a Uint8Array")}}function g(e){if("object"!=typeof e)throw Error("FhevmStoredPublicParams must be an object");if(null!==e){if(!("publicParamsId"in e))throw Error("FhevmStoredPublicParams.publicParamsId does not exist");if("string"!=typeof e.publicParamsId)throw Error("FhevmStoredPublicParams.publicParamsId must be a string");if(!("publicParams"in e))throw Error("FhevmStoredPublicParams.publicParams does not exist");if(!(e.publicParams instanceof Uint8Array))throw Error("FhevmStoredPublicParams.publicParams must be a Uint8Array")}}async function f(e){let t,r=await h();if(!r)return{publicParams:null};let a=null;try{let t=await r.get("publicKeyStore",e);(null==t?void 0:t.value)&&(m(t.value),a=t.value)}catch(e){}let n=null;try{let t=await r.get("paramsStore",e);(null==t?void 0:t.value)&&(g(t.value),n=t.value)}catch(e){}let s=null==a?void 0:a.publicKey,i=null==a?void 0:a.publicKeyId,l=n?{2048:n}:null;return i&&s&&(t={id:i,data:s}),{...void 0!==t&&{publicKey:t},publicParams:l}}async function b(e,t,r){m(t),g(r);let a=await h();a&&(t&&await a.put("publicKeyStore",{acl:e,value:t}),r&&await a.put("paramsStore",{acl:e,value:r}))}let w=async e=>{if(!u(window,console.log))throw Error("window.relayerSDK is not available");let t=await window.relayerSDK.initSDK(e);if(window.relayerSDK.__initialized__=t,!t)throw Error("window.relayerSDK.initSDK failed.");return!0};class x extends Error{constructor(e="FHEVM operation was cancelled"){super(e),this.name="FhevmAbortError"}}async function v(e){try{if("string"==typeof e){let t=new l.FR(e,void 0,{staticNetwork:!0});try{let e=await Promise.race([t.send("eth_chainId",[]),new Promise((e,t)=>setTimeout(()=>t(Error("Provider request timeout")),1e4))]);return Number.parseInt(e,16)}finally{t.destroy()}}{let t=await Promise.race([e.request({method:"eth_chainId"}),new Promise((e,t)=>setTimeout(()=>t(Error("Provider request timeout")),1e4))]);return Number.parseInt(t,16)}}catch(r){let t=(null==r?void 0:r.message)||String(r);if(t.includes("Failed to fetch")||t.includes("fetch")){if("string"==typeof e&&(e.includes("localhost")||e.includes("127.0.0.1")))return 31337;throw Error("CHAIN_ID_UNAVAILABLE")}throw r}}async function S(e){let t=new l.FR(e,void 0,{staticNetwork:!0});try{return await Promise.race([t.send("web3_clientVersion",[]),new Promise((e,t)=>setTimeout(()=>t(Error("RPC request timeout")),1e4))])}catch(e){throw e}finally{t.destroy()}}async function j(e){try{let t=await S(e);if("string"!=typeof t||!t.toLowerCase().includes("hardhat"))return}catch(t){console.debug("[FHEVM] Could not connect to ".concat(e," - this is normal if using a different network or if the node is not running"));return}try{let t=await D(e);if(!t||"object"!=typeof t||!("ACLAddress"in t&&"string"==typeof t.ACLAddress&&t.ACLAddress.startsWith("0x"))||!("InputVerifierAddress"in t&&"string"==typeof t.InputVerifierAddress&&t.InputVerifierAddress.startsWith("0x"))||!("KMSVerifierAddress"in t&&"string"==typeof t.KMSVerifierAddress&&t.KMSVerifierAddress.startsWith("0x")))return;return t}catch(r){let t=(null==r?void 0:r.message)||String(r);t.includes("Failed to fetch")||t.includes("fetch")?console.debug("[FHEVM] Could not fetch relayer metadata from ".concat(e," - this is normal if not using FHEVM Hardhat node")):console.debug("[FHEVM] Relayer metadata not available from ".concat(e," - this is normal"));return}}async function D(e){let t=new l.FR(e,void 0,{staticNetwork:!0});try{return await Promise.race([t.send("fhevm_relayer_metadata",[]),new Promise((e,t)=>setTimeout(()=>t(Error("RPC request timeout")),1e4))])}catch(e){throw e}finally{t.destroy()}}async function N(e,t){try{let r=await v(e),a="string"==typeof e?e:void 0,n={31337:"http://localhost:8545",...null!=t?t:{}};if(Object.hasOwn(n,r))return a||(a=n[r]),{isMock:!0,chainId:r,rpcUrl:a};return{isMock:!1,chainId:r,rpcUrl:a}}catch(a){if("string"==typeof e){for(let[r,a]of Object.entries({31337:"http://localhost:8545",...null!=t?t:{}}))if(e===a||e.includes(a.replace("http://","").replace("https://","")))return console.debug("[FHEVM] Using mock chain ".concat(r," for ").concat(e," (chainId fetch failed but URL matches)")),{isMock:!0,chainId:Number(r),rpcUrl:e};if(e.includes("localhost")||e.includes("127.0.0.1"))return console.debug("[FHEVM] Assuming localhost URL ".concat(e," is mock chain 31337")),{isMock:!0,chainId:31337,rpcUrl:e}}let r=(null==a?void 0:a.message)||String(a);if((r.includes("Failed to fetch")||r.includes("fetch"))&&"string"==typeof e){for(let[r,a]of Object.entries({31337:"http://localhost:8545",...null!=t?t:{}}))if(e===a||e.includes(a.replace("http://","").replace("https://","")))return{isMock:!0,chainId:Number(r),rpcUrl:e};if(e.includes("localhost")||e.includes("127.0.0.1"))return{isMock:!0,chainId:31337,rpcUrl:e}}throw a}}let E=async e=>{let t=()=>{if(n.aborted)throw new x},a=e=>{s&&s(e)},{signal:n,onStatusChange:s,provider:l,mockChains:o}=e,{isMock:c,rpcUrl:p,chainId:y}=await N(l,o);if(c&&p){console.log("[FHEVM] Detected mock chain, attempting to fetch Hardhat node metadata...",{chainId:y,rpcUrl:p});let e=await j(p);if(e){console.log("[FHEVM] Hardhat node FHEVM metadata found, using mock instance:",e),a("creating");let n=await Promise.all([r.e(2235),r.e(7079)]).then(r.bind(r,47079)),s=await n.fhevmMockCreateInstance({rpcUrl:p,chainId:y,metadata:e});return t(),console.log("[FHEVM] Mock FHEVM instance created successfully"),s}{console.warn("[FHEVM] Hardhat node FHEVM metadata not found. This may cause issues if Hardhat node is not running with FHEVM support."),console.warn("[createFhevmInstance] Using hardcoded FHEVM metadata for local development"),a("creating");let e=await Promise.all([r.e(2235),r.e(7079)]).then(r.bind(r,47079)),n=await e.fhevmMockCreateInstance({rpcUrl:p,chainId:y,metadata:{ACLAddress:"0x50157CFfD6bBFA2DECe204a89ec419c23ef5755D",InputVerifierAddress:"0x901F8942346f7AB3a01F6D7613119Bca447Bb030",KMSVerifierAddress:"0x1364cBBf2cDF5032C47d8226a6f6FBD2AFCDacAC"}});return t(),n}}t(),u(window,console.log)||(a("sdk-loading"),await new d({trace:console.log}).load(),t(),a("sdk-loaded")),u(window,console.log)&&!0===window.relayerSDK.__initialized__||(a("sdk-initializing"),await w(),t(),a("sdk-initialized"));let h=window.relayerSDK,m=h.SepoliaConfig.aclContractAddress;if(!function(e){return"string"==typeof e&&!!(0,i.PW)(e)}(m))throw Error("Invalid address: ".concat(m));let g=await f(m);t();let v={...h.SepoliaConfig,network:l,publicKey:g.publicKey,publicParams:g.publicParams};a("creating");let S=await h.createInstance(v);return await b(m,S.getPublicKey(),S.getPublicParams(2048)),t(),S};function P(e,t){if(!e){let e=t?"Assertion failed: ".concat(t):"Assertion failed.";throw console.error(e),Error(e)}}var C=r(98814),K=r(10557),T=r(82127),A=r(43338),R=r(99353),M=r(16405);let I={0xaa36a7:{address:"0xf09ca095e56b11AB5a34677B4798C7186892A137",chainId:0xaa36a7,chainName:"sepolia"},31337:{address:"0x5FbDB2315678afecb367f032d93F642f64180aa3",chainId:31337,chainName:"hardhat"}},k={abi:[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"date",type:"uint256"}],name:"ScheduleCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"date",type:"uint256"},{indexed:!1,internalType:"uint256",name:"completionRate",type:"uint256"},{indexed:!1,internalType:"uint256",name:"avgPriority",type:"uint256"}],name:"ScheduleDecrypted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"date",type:"uint256"}],name:"ScheduleUpdated",type:"event"},{inputs:[{internalType:"uint256",name:"date",type:"uint256"},{internalType:"externalEuint32",name:"encryptedTargetGoals",type:"bytes32"},{internalType:"externalEuint32",name:"encryptedCompletedGoals",type:"bytes32"},{internalType:"externalEuint32",name:"encryptedPriority",type:"bytes32"},{internalType:"bytes",name:"inputProof",type:"bytes"}],name:"createOrUpdateSchedule",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"date",type:"uint256"}],name:"getEncryptedAveragePriorityData",outputs:[{internalType:"euint32",name:"totalPriority",type:"bytes32"},{internalType:"euint32",name:"priorityCount",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"date",type:"uint256"}],name:"getEncryptedCompletedGoals",outputs:[{internalType:"euint32",name:"encryptedCompletedGoals",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"date",type:"uint256"}],name:"getEncryptedCompletionRateData",outputs:[{internalType:"euint32",name:"completedGoals",type:"bytes32"},{internalType:"euint32",name:"targetGoals",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"date",type:"uint256"}],name:"getEncryptedPriorityCount",outputs:[{internalType:"euint32",name:"encryptedPriorityCount",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"date",type:"uint256"}],name:"getEncryptedTargetGoals",outputs:[{internalType:"euint32",name:"encryptedTargetGoals",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"date",type:"uint256"}],name:"getEncryptedTotalPriority",outputs:[{internalType:"euint32",name:"encryptedTotalPriority",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"date",type:"uint256"}],name:"getScheduleDate",outputs:[{internalType:"uint256",name:"scheduleDate",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserDates",outputs:[{internalType:"uint256[]",name:"dates",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserScheduleCount",outputs:[{internalType:"uint256",name:"count",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"protocolId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"date",type:"uint256"}],name:"scheduleExists",outputs:[{internalType:"bool",name:"exists",type:"bool"}],stateMutability:"view",type:"function"}]},F=(0,s.forwardRef)((e,t)=>{let{label:r,error:a,className:s="",...i}=e;return(0,n.jsxs)("div",{className:"w-full",children:[r&&(0,n.jsx)("label",{className:"block text-white mb-2 text-sm font-medium",children:r}),(0,n.jsx)("input",{ref:t,className:"w-full px-4 py-2.5 border rounded-lg bg-white/5 backdrop-blur-sm border-white/20 text-white placeholder-white/50 focus:ring-2 focus:ring-gray-400 focus:border-transparent transition-all duration-200 ".concat(a?"border-red-400 focus:ring-red-500":""," ").concat(s),...i}),a&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-400",children:a})]})});function _(e){let{children:t,className:r="",variant:a="default"}=e;return(0,n.jsx)("div",{className:"rounded-xl p-6 ".concat({default:"bg-white/10 backdrop-blur-sm border-2 border-white/20",highlight:"bg-gray-700/40 backdrop-blur-sm border-2 border-gray-400/30",muted:"bg-white/5 backdrop-blur-sm border border-white/10"}[a]," ").concat(r),children:t})}function L(e){let{selectedDate:t,targetGoals:r,completedGoals:a,priority:s,onDateChange:i,onTargetGoalsChange:l,onCompletedGoalsChange:o,onPriorityChange:d,errors:c={}}=e;return(0,n.jsxs)(_,{children:[(0,n.jsx)("h2",{className:"font-semibold text-white text-xl mb-4",children:"Schedule Input"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsx)(F,{type:"date",label:"Date",value:t,onChange:e=>i(e.target.value)}),(0,n.jsx)(F,{type:"number",label:"Target Goals",min:"1",value:r,onChange:e=>l(e.target.value),error:c.targetGoals}),(0,n.jsx)(F,{type:"number",label:"Completed Goals",min:"0",value:a,onChange:e=>o(e.target.value),error:c.completedGoals}),(0,n.jsx)(F,{type:"number",label:"Priority (1-3)",min:"1",max:"3",value:s,onChange:e=>d(e.target.value),error:c.priority})]})]})}F.displayName="Input";var H=r(73470),V=r(29565),G=r(98534),U=r(13490),z=r(4556),O=r(37296),B=r(14158),q=r(44641);function W(e){let{variant:t="primary",size:r="md",isLoading:a=!1,className:s="",disabled:i,children:l,...o}=e;return(0,n.jsxs)("button",{className:"".concat("inline-flex items-center justify-center rounded-xl font-semibold text-white shadow-sm transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat({primary:"bg-gray-700 hover:bg-gray-600 active:bg-gray-800 focus-visible:ring-gray-500 text-white",secondary:"bg-gray-600 hover:bg-gray-500 active:bg-gray-700 focus-visible:ring-gray-400 text-white",success:"bg-green-600 hover:bg-green-700 active:bg-green-800 focus-visible:ring-green-500 text-white",danger:"bg-red-600 hover:bg-red-700 active:bg-red-800 focus-visible:ring-red-500 text-white",ghost:"bg-white/10 hover:bg-white/20 active:bg-white/30 focus-visible:ring-white/50 text-white"}[t]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[r]," ").concat(s),disabled:i||a,...o,children:[a&&(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"}),l]})}function Y(e){let{value:t,max:r=100,className:a="",showLabel:s=!1}=e,i=Math.min(Math.max(t/r*100,0),100);return(0,n.jsxs)("div",{className:"w-full ".concat(a),children:[s&&(0,n.jsxs)("div",{className:"flex justify-between text-xs text-white/60 mb-1",children:[(0,n.jsx)("span",{children:"Progress"}),(0,n.jsxs)("span",{children:[i.toFixed(1),"%"]})]}),(0,n.jsx)("div",{className:"w-full bg-white/10 rounded-full h-2.5 overflow-hidden",children:(0,n.jsx)("div",{className:"h-full ".concat(i>=80?"bg-green-500":i>=50?"bg-yellow-500":"bg-red-500"," transition-all duration-500 ease-out rounded-full"),style:{width:"".concat(i,"%")}})})]})}function Z(e){let{selectedDate:t,showDecrypted:r,isRefreshing:a,decryptedTargetGoals:s,decryptedCompletedGoals:i,decryptedCompletionRate:l,decryptedAvgPriority:o,onRefresh:d,onDecrypt:c,onHide:u,canDecrypt:p,isDecrypting:y}=e,h=l?Number(l):void 0,m=s?Number(s):void 0,g=i?Number(i):void 0;return(0,n.jsxs)(_,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(H.A,{className:"w-5 h-5 text-gray-300"}),(0,n.jsx)("span",{className:"font-semibold text-white text-xl",children:"Encrypted Study Data"})]}),(0,n.jsxs)(W,{variant:"ghost",size:"sm",onClick:d,disabled:a,isLoading:a,children:[(0,n.jsx)(V.A,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-white/60",children:"Date:"}),(0,n.jsx)("span",{className:"ml-2 text-white font-mono font-medium",children:t})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-white/60",children:"Status:"}),(0,n.jsx)("span",{className:"ml-2 text-green-400 font-medium",children:"Encrypted"})]})]})}),r&&(0,n.jsx)("div",{className:"space-y-4 animate-fade-in",children:(0,n.jsxs)("div",{className:"bg-gradient-to-br from-gray-800/40 to-gray-700/40 rounded-lg p-6 border border-gray-500/30",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(G.A,{className:"w-5 h-5 text-green-400"}),(0,n.jsx)("span",{className:"font-semibold text-white text-lg",children:"Decrypted Results"})]}),(0,n.jsxs)(W,{variant:"ghost",size:"sm",onClick:u,children:[(0,n.jsx)(U.A,{className:"w-4 h-4 mr-2"}),"Hide"]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[void 0!==m&&(0,n.jsxs)("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(z.A,{className:"w-4 h-4 text-gray-300"}),(0,n.jsx)("span",{className:"text-sm text-gray-200 font-medium",children:"Target Goals"})]}),(0,n.jsx)("span",{className:"text-3xl font-bold text-white",children:m})]}),void 0!==g&&(0,n.jsxs)("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(O.A,{className:"w-4 h-4 text-green-400"}),(0,n.jsx)("span",{className:"text-sm text-green-300 font-medium",children:"Completed Goals"})]}),(0,n.jsx)("span",{className:"text-3xl font-bold text-white",children:g})]}),void 0!==h&&(0,n.jsxs)("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(B.A,{className:"w-4 h-4 text-blue-400"}),(0,n.jsx)("span",{className:"text-sm text-blue-300 font-medium",children:"Completion Rate"})]}),(0,n.jsxs)("span",{className:"text-3xl font-bold text-white",children:[h.toFixed(1),"%"]}),(0,n.jsx)(Y,{value:h,className:"mt-3"})]}),void 0!==o&&(0,n.jsxs)("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(q.A,{className:"w-4 h-4 text-yellow-400"}),(0,n.jsx)("span",{className:"text-sm text-yellow-300 font-medium",children:"Avg Priority"})]}),(0,n.jsx)("span",{className:"text-3xl font-bold text-white",children:Number(o).toFixed(1)})]})]})]})}),!r&&(0,n.jsx)("div",{className:"bg-white/5 rounded-lg p-6 border border-white/10 text-center",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-3 text-white/60",children:[(0,n.jsx)(U.A,{className:"w-8 h-8"}),(0,n.jsx)("p",{children:"Data is encrypted. Click decrypt to view your results."}),(0,n.jsxs)(W,{variant:"success",onClick:c,disabled:!p,isLoading:y,className:"mt-2",children:[(0,n.jsx)(G.A,{className:"w-4 h-4 mr-2"}),"Decrypt Data"]})]})})]})]})}var $=r(72554),J=r(121);function Q(e){let{message:t}=e;if(!t)return null;let r=t.includes("Error")||t.includes("not")||t.includes("Missing")||t.includes("failed"),a=t.includes("successfully")||t.includes("Success"),s=r?$.A:a?O.A:J.A;return(0,n.jsx)(_,{variant:r?"highlight":"default",className:"border-2",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)(s,{className:"w-5 h-5 mt-0.5 flex-shrink-0 ".concat(r?"text-red-400":a?"text-green-400":"text-gray-300")}),(0,n.jsx)("p",{className:"text-sm ".concat(r?"text-red-300":a?"text-green-300":"text-gray-200"," whitespace-pre-wrap"),children:t})]})})}let X=()=>{let{storage:e}=(0,C.p)(),{provider:t,chainId:r,accounts:a,isConnected:i,connect:l,ethersSigner:o,ethersReadonlyProvider:d,sameChain:c,sameSigner:u,initialMockChains:p}=(0,K.z)(),[y,h]=(0,s.useState)(new Date().toISOString().split("T")[0]),[m,g]=(0,s.useState)("5"),[f,b]=(0,s.useState)("3"),[w,x]=(0,s.useState)("2"),[v,S]=(0,s.useState)(!1),[j,D]=(0,s.useState)({}),{instance:N,status:F,error:H}=function(e){let{provider:t,chainId:r,initialMockChains:a,enabled:n=!0}=e,[i,l]=(0,s.useState)(void 0),[o,d]=(0,s.useState)("idle"),[c,u]=(0,s.useState)(void 0),[p,y]=(0,s.useState)(n),[h,m]=(0,s.useState)(0),g=(0,s.useRef)(null),f=(0,s.useRef)(t),b=(0,s.useRef)(r),w=(0,s.useRef)(a),x=(0,s.useCallback)(()=>{g.current&&(f.current=void 0,b.current=void 0,g.current.abort(),g.current=null),f.current=t,b.current=r,l(void 0),u(void 0),d("idle"),void 0!==t&&m(e=>e+1)},[t,r]);return(0,s.useEffect)(()=>{x()},[x]),(0,s.useEffect)(()=>{y(n)},[n]),(0,s.useEffect)(()=>{if(!1===p){console.log("cancelled"),g.current&&(g.current.abort(),g.current=null),l(void 0),u(void 0),d("idle");return}if(!0===p){if(void 0===f.current){l(void 0),u(void 0),d("idle");return}g.current||(g.current=new AbortController),P(!g.current.signal.aborted,"!controllerRef.current.signal.aborted"),d("loading"),u(void 0);let e=g.current.signal,t=f.current;E({signal:e,provider:t,mockChains:w.current,onStatusChange:e=>{}}).then(r=>{e.aborted||(P(t===f.current,"thisProvider === _providerRef.current"),l(r),u(void 0),d("ready"))}).catch(r=>{console.log("Error Was thrown !!! error... "+r.name),e.aborted||(P(t===f.current,"thisProvider === _providerRef.current"),l(void 0),u(r),d("error"))})}},[p,h]),{instance:i,refresh:x,error:c,status:o}}({provider:t,chainId:r,initialMockChains:p,enabled:!0}),V=r||(i&&t?31337:void 0),G=(e=>{let{instance:t,fhevmDecryptionSignatureStorage:r,chainId:a,ethersSigner:n,ethersReadonlyProvider:i,sameChain:l,sameSigner:o}=e,[d,c]=(0,s.useState)(void 0),[u,p]=(0,s.useState)(void 0),[y,h]=(0,s.useState)(void 0),[m,g]=(0,s.useState)(void 0),[f,b]=(0,s.useState)(void 0),[w,x]=(0,s.useState)(void 0),[v,S]=(0,s.useState)(void 0),[j,D]=(0,s.useState)(void 0),[N,E]=(0,s.useState)(!1),[P,C]=(0,s.useState)(!1),[K,F]=(0,s.useState)(!1),[_,L]=(0,s.useState)(""),[H,V]=(0,s.useState)(void 0),[G,U]=(0,s.useState)(void 0),z=(0,s.useRef)(void 0),O=(0,s.useRef)(N);(0,s.useRef)(P),(0,s.useRef)(K),(0,s.useCallback)(()=>31337===a?"http://localhost:8545":e.eip1193Provider?e.eip1193Provider:window.ethereum?window.ethereum:void 0,[a,e.eip1193Provider]),(0,s.useEffect)(()=>{e.ethersReadonlyProvider&&U(e.ethersReadonlyProvider)},[e.ethersReadonlyProvider]);let B=(0,s.useMemo)(()=>{let e=function(e){var t;if(!e)return{abi:k.abi};let r=I[e.toString()];return r&&"address"in r&&r.address!==T.j?{address:null==r?void 0:r.address,chainId:null!=(t=null==r?void 0:r.chainId)?t:e,chainName:null==r?void 0:r.chainName,abi:k.abi}:{abi:k.abi,chainId:e}}(a);return z.current=e,e.address||void 0===a||L("StudySchedule deployment not found for chainId=".concat(a,".")),e},[a]),q=(0,s.useMemo)(()=>{if(B)return!!B.address&&B.address!==T.j},[B]),W=(0,s.useMemo)(()=>B.address&&i&&!N&&void 0!==H,[B.address,i,N,H]),Y=(0,s.useMemo)(()=>B.address&&t&&n&&!N&&!K,[B.address,t,n,N,K]),Z=(0,s.useMemo)(()=>!!(B.address&&t&&n&&!N&&!P&&(d||u||y||m)&&void 0!==H),[B.address,t,n,N,P,d,u,y,m,H]),$=(0,s.useCallback)(e=>{var t,r;if(O.current)return;if(!z.current||!(null==(t=z.current)?void 0:t.chainId)||!(null==(r=z.current)?void 0:r.address)||!i||!n){c(void 0),p(void 0),h(void 0),g(void 0);return}O.current=!0,E(!0),V(e);let a=z.current.chainId,s=z.current.address,o=new A.NZ(s,z.current.abi,i);Promise.all([o.getEncryptedTargetGoals(n.address,e).catch(()=>R.p),o.getEncryptedCompletedGoals(n.address,e).catch(()=>R.p),o.getEncryptedCompletionRateData(n.address,e).then(e=>{let[t,r]=e;return t}).catch(()=>R.p),o.getEncryptedAveragePriorityData(n.address,e).then(e=>{let[t,r]=e;return t}).catch(()=>R.p)]).then(e=>{var t;let[r,n,i,o]=e;l.current(a)&&s===(null==(t=z.current)?void 0:t.address)&&(c(r),p(n),h(i),g(o))}).catch(e=>{L("StudySchedule.getEncrypted*() call failed! error="+e)}).finally(()=>{O.current=!1,E(!1)})},[i,n,l]),J=(0,s.useCallback)(async e=>{if(!B.address||!G||!t||!n||!n.address)return void L("Missing requirements for decryption");if(!d&&!u&&!y&&!m)return void L("No encrypted data available to decrypt");try{let r,s;C(!0),L("Checking permissions and fetching latest encrypted data...");let i=new A.NZ(B.address,B.abi,G),l=await i.getEncryptedTargetGoals(n.address,e).catch(()=>R.p),o=await i.getEncryptedCompletedGoals(n.address,e).catch(()=>R.p),[d,u]=await i.getEncryptedCompletionRateData(n.address,e).catch(()=>[R.p,R.p]),[y,m]=await i.getEncryptedAveragePriorityData(n.address,e).catch(()=>[R.p,R.p]),f=[];if(l&&l!==R.p&&f.push({handle:l,contractAddress:B.address}),o&&o!==R.p&&f.push({handle:o,contractAddress:B.address}),d&&d!==R.p&&f.push({handle:d,contractAddress:B.address}),u&&u!==R.p&&f.push({handle:u,contractAddress:B.address}),y&&y!==R.p&&f.push({handle:y,contractAddress:B.address}),m&&m!==R.p&&f.push({handle:m,contractAddress:B.address}),0===f.length)throw Error("No valid encrypted data found. Please add schedule data first before decrypting.");console.log("[useStudySchedule] ===== Decryption Debug Info ====="),console.log("[useStudySchedule] Contract address:",B.address),console.log("[useStudySchedule] User address:",n.address),console.log("[useStudySchedule] Chain ID:",a),console.log("[useStudySchedule] Handles to decrypt:",f.length),L("Decrypting schedule data..."),r="function"==typeof t.generateKeypair?t.generateKeypair():{publicKey:new Uint8Array(32).fill(0),privateKey:new Uint8Array(32).fill(0)};let w=[B.address],v=Math.floor(Date.now()/1e3).toString();s="function"==typeof t.createEIP712?t.createEIP712(r.publicKey,w,v,"10"):{domain:{name:"FHEVM",version:"1",chainId:a,verifyingContract:w[0]},types:{UserDecryptRequestVerification:[{name:"publicKey",type:"bytes"},{name:"contractAddresses",type:"address[]"},{name:"startTimestamp",type:"string"},{name:"durationDays",type:"string"}]},message:{publicKey:M.c$(r.publicKey),contractAddresses:w,startTimestamp:v,durationDays:"10"}};let j=await n.signTypedData(s.domain,{UserDecryptRequestVerification:s.types.UserDecryptRequestVerification},s.message),N=31337===a?j.replace("0x",""):j;console.log("[useStudySchedule] Decrypting with:",{handleCount:f.length,contractAddress:B.address,userAddress:n.address,chainId:a,signatureLength:j.length,signatureForDecryptLength:N.length});let E=await t.userDecrypt(f,r.privateKey,r.publicKey,N,w,n.address,v,"10");console.log("[useStudySchedule] Decryption successful"),l&&l!==R.p&&void 0!==E[l]&&b({handle:l,clear:E[l]}),o&&o!==R.p&&void 0!==E[o]&&x({handle:o,clear:E[o]}),d&&d!==R.p&&void 0!==E[d]&&S({handle:d,clear:E[d]}),y&&y!==R.p&&void 0!==E[y]&&D({handle:y,clear:E[y]}),c(l),p(o),h(d),g(y),L("Schedule decrypted successfully!")}catch(t){console.error("[useStudySchedule] Error decrypting schedule:",t);let e=t.message||String(t);throw e.includes("not authorized")||e.includes("authorized")?L("Decryption failed: You don't have permission to decrypt this data. This may happen if:\n1. The contract was redeployed and the data is from an old deployment\n2. You haven't added schedule data yet\n3. The transaction hasn't fully confirmed yet\n\nPlease try:\n1. Add schedule data again to get new encrypted data with proper permissions\n2. Wait a few seconds after adding data before decrypting\n3. Refresh the page and try again"):L("Error decrypting: ".concat(e)),t}finally{C(!1)}},[B.address,B.abi,G,t,n,a,d,u,y,m]),Q=(0,s.useCallback)(async(e,r,a,s)=>{if(console.log("[useStudySchedule] createOrUpdateSchedule called",{date:e,targetGoals:r,completedGoals:a,priority:s,contractAddress:B.address,hasEthersSigner:!!n,hasFhevmInstance:!!t,hasEthersProvider:!!G}),!B.address){let e=Error("Contract address not configured. Please set VITE_CONTRACT_ADDRESS in .env.local");throw L(e.message),console.error("[useStudySchedule] Missing contract address"),e}if(!n){let e=Error("Wallet signer not available. Please ensure your wallet is connected.");throw L(e.message),console.error("[useStudySchedule] Missing ethers signer"),e}if(!t){let e=Error("FHEVM instance not initialized. Please wait for initialization.");throw L(e.message),console.error("[useStudySchedule] Missing FHEVM instance"),e}if(!G){let e=Error("Ethers provider not available.");throw L(e.message),console.error("[useStudySchedule] Missing ethers provider"),e}if(r<1||a<0||s<1||s>3){let e=Error("Invalid input values: target goals must be >= 1, completed goals must be >= 0, priority must be 1-3");throw L(e.message),e}try{F(!0),L("Encrypting schedule data...");let i=await G.getCode(B.address);if("0x"===i||i.length<=2)throw Error("Contract not deployed at ".concat(B.address,". Please deploy the contract first."));let l=new A.NZ(B.address,B.abi,n),o=t.createEncryptedInput(B.address,n.address);o.add32(r),o.add32(a),o.add32(s);let d=await o.encrypt();console.log("[useStudySchedule] Encryption complete",{hasHandles:!!d.handles&&d.handles.length>0,hasInputProof:!!d.inputProof&&d.inputProof.length>0}),L("Submitting to blockchain...");let c=d.handles[0],u=d.handles[1],p=d.handles[2];if(!c||!u||!p||!d.inputProof||0===d.inputProof.length)throw Error("Encryption failed - missing handles or proof");console.log("[useStudySchedule] Submitting transaction...");let y=await l.createOrUpdateSchedule(e,c,u,p,d.inputProof,{gasLimit:5e6});console.log("[useStudySchedule] Transaction sent:",y.hash);let h=await y.wait();console.log("[useStudySchedule] Transaction confirmed, block:",h.blockNumber),L("Schedule updated successfully! Refreshing data..."),console.log("[useStudySchedule] Waiting for state update and permissions..."),await new Promise(e=>setTimeout(e,2e3)),$(e),L("Schedule updated successfully!")}catch(t){let e=t.reason||t.message||String(t);throw L("Error: ".concat(e)),console.error("[useStudySchedule] Error updating schedule:",t),t}finally{F(!1)}},[B.address,B.abi,n,t,G,$]);return{contractAddress:B.address,isDeployed:q,canRefresh:W,canSubmit:Y,canDecrypt:Z,createOrUpdateSchedule:Q,decryptSchedule:J,refreshSchedule:$,message:_,isRefreshing:N,isDecrypting:P,isSubmitting:K,decryptedTargetGoals:null==f?void 0:f.clear,decryptedCompletedGoals:null==w?void 0:w.clear,decryptedCompletionRate:null==v?void 0:v.clear,decryptedAvgPriority:null==j?void 0:j.clear}})({instance:N,fhevmDecryptionSignatureStorage:e,eip1193Provider:t,chainId:V,ethersSigner:o,ethersReadonlyProvider:d,sameChain:c,sameSigner:u});if(!i)return(0,n.jsx)("div",{className:"w-full flex justify-center items-center min-h-[60vh]",children:(0,n.jsxs)(_,{variant:"highlight",className:"text-center max-w-md",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Connect Your Wallet"}),(0,n.jsx)("p",{className:"text-white/70 mb-6",children:"Please connect your wallet to start tracking your encrypted study schedule."}),(0,n.jsx)(W,{variant:"primary",size:"lg",onClick:l,className:"w-full",children:"Connect Wallet"})]})});if(!1===G.isDeployed)return(0,n.jsxs)("div",{className:"mx-auto p-8 bg-red-500/20 border-2 border-red-500 rounded-lg",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Contract Not Deployed"}),(0,n.jsxs)("p",{className:"text-white",children:["The StudySchedule contract is not deployed on chainId=",r,"."]}),(0,n.jsxs)("p",{className:"text-white mt-2",children:["Please deploy the contract first by running: ",(0,n.jsx)("code",{className:"bg-black/50 px-2 py-1 rounded",children:"npx hardhat deploy --network localhost"})]})]});let U=async()=>{if(!(()=>{let e={},t=!0,r=parseInt(m),a=parseInt(f),n=parseInt(w);return(isNaN(r)||r<1)&&(e.targetGoals="Target goals must be at least 1",t=!1),(isNaN(a)||a<0)&&(e.completedGoals="Completed goals must be 0 or greater",t=!1),a>r&&(e.completedGoals="Completed goals cannot exceed target goals",t=!1),(isNaN(n)||n<1||n>3)&&(e.priority="Priority must be between 1 and 3",t=!1),D(e),t})())return;let e=new Date(y);e.setHours(0,0,0,0);let t=Math.floor(e.getTime()/1e3);try{await G.createOrUpdateSchedule(t,parseInt(m),parseInt(f),parseInt(w)),S(!1),D({})}catch(e){console.error("Submit failed:",e)}},z=async()=>{try{let e=new Date(y);e.setHours(0,0,0,0);let t=Math.floor(e.getTime()/1e3);await G.decryptSchedule(t),S(!0)}catch(e){console.error("Decryption failed:",e)}};return(0,n.jsxs)("div",{className:"w-full max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6 py-8",children:[(0,n.jsxs)(_,{variant:"highlight",className:"text-center",children:[(0,n.jsx)("h1",{className:"font-bold text-3xl sm:text-4xl text-white mb-2",children:"Encrypted Study Schedule"}),(0,n.jsx)("p",{className:"text-white/70 text-sm sm:text-base",children:"Track your daily study progress with fully encrypted, privacy-preserving data"})]}),(0,n.jsx)(L,{selectedDate:y,targetGoals:m,completedGoals:f,priority:w,onDateChange:h,onTargetGoalsChange:g,onCompletedGoalsChange:b,onPriorityChange:x,errors:j}),(0,n.jsx)(Z,{selectedDate:y,showDecrypted:v,isRefreshing:G.isRefreshing,decryptedTargetGoals:G.decryptedTargetGoals,decryptedCompletedGoals:G.decryptedCompletedGoals,decryptedCompletionRate:G.decryptedCompletionRate,decryptedAvgPriority:G.decryptedAvgPriority,onRefresh:()=>{let e=new Date(y);e.setHours(0,0,0,0);let t=Math.floor(e.getTime()/1e3);G.refreshSchedule(t),S(!1)},onDecrypt:z,onHide:()=>S(!1),canDecrypt:G.canDecrypt,isDecrypting:G.isDecrypting}),(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,n.jsx)(W,{variant:"primary",size:"lg",disabled:!G.canSubmit,onClick:U,isLoading:G.isSubmitting,className:"w-full",children:G.isSubmitting?"Submitting...":"Submit Schedule"}),v?(0,n.jsx)(W,{variant:"secondary",size:"lg",onClick:()=>S(!1),className:"w-full",children:"Hide Results"}):(0,n.jsx)(W,{variant:"success",size:"lg",disabled:!G.canDecrypt,onClick:z,isLoading:G.isDecrypting,className:"w-full",children:G.isDecrypting?"Decrypting...":"Decrypt Data"})]}),G.message&&(0,n.jsx)(Q,{message:G.message})]})},ee="force-dynamic";function et(){return(0,n.jsx)("main",{className:"w-full",children:(0,n.jsx)(X,{})})}}},e=>{e.O(0,[8655,2428,8178,8441,1255,7358],()=>e(e.s=1298)),_N_E=e.O()}]);